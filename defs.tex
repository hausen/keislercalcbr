\newcommand{\Cdot}{\raisebox{-0.5ex}{\scalebox{2}{$\cdot$}}}
\newcommand{\hypersymb}{\#}
\newcommand{\hyper}[1]{{#1}^\hypersymb}

\newcommand{\dsfrac}[2]{\frac{\mbox{\normalsize\strut$#1$}}{\mbox{\normalsize\strut$#2$}}}

\newcommand{\Dy}{\Delta y}
\newcommand{\Dx}{\Delta x}
\newcommand{\Dz}{\Delta z}
\newcommand{\Du}{\Delta u}
\newcommand{\Dv}{\Delta v}
\newcommand{\Dt}{\delta t}
\newcommand{\dy}{\dif y}
\newcommand{\dx}{\dif x}
\newcommand{\dz}{\dif z}
\newcommand{\du}{\dif u}
\newcommand{\dv}{\dif v}
\newcommand{\dt}{\dif t}

\newcolumntype{d}[1]{D{.}{,}{#1}}

\newcommand{\tnote}[1]{%
\footnote{N. do T.: #1}%
}

\newenvironment{caseanalysis}%
  {\par\indent\begin{enumerate}[\emph{Caso} \itshape1:]}%
  {\end{enumerate}}

\newenvironment{stepanalysis}%
  {\par\indent\begin{enumerate}[\emph{Passo} \itshape1:]}%
  {\end{enumerate}}

\newenvironment{enumeratewithspaces}[1][]%
  {\begingroup\setlength{\parskip}{1ex}\begin{enumerate}[#1]}%
  {\end{enumerate}\endgroup}%

% isto faz com que os contadores de exemplos e teoremas sejam
% reiniciados a cada seção
\makeatletter
\@addtoreset{theorem}{section}
\@addtoreset{example}{section}
\@addtoreset{corollary}{section}
\@addtoreset{lemma}{section}
\makeatother

% coloca o número da seção nas figuras
\usepackage{chngcntr}
\counterwithin{figure}{section}
\counterwithin{table}{section}
\counterwithin{equation}{section}
\renewcommand{\theequation}{\arabic{equation}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% commands to typeset the problem sections
% \exer - typeset one exercise
% \twoexer - typeset two exercises side by side
% \hardex - typeset a hard exercise
\newcounter{exerciseNo}

\newcommand{\exer}[1]{%

\begingroup%
\noindent\par%
\refstepcounter{exerciseNo}%
\begin{minipage}[t]{0.1\textwidth}%
\hspace{3ex}\textbf{\arabic{exerciseNo}}%
\end{minipage}%
\begin{minipage}[t]{0.9\textwidth}%
#1
\end{minipage}
\endgroup%

}

\newcommand{\twoexer}[2]{%

\begingroup%
\noindent\par%
\refstepcounter{exerciseNo}%
\begin{minipage}[t]{0.1\textwidth}
\hspace{3ex}\textbf{\arabic{exerciseNo}}
\end{minipage}%
\begin{minipage}[t]{0.4\textwidth}
#1
\end{minipage}%
\refstepcounter{exerciseNo}%
\begin{minipage}[t]{0.1\textwidth}
\hspace{3ex}\textbf{\arabic{exerciseNo}}
\end{minipage}%
\begin{minipage}[t]{0.4\textwidth}
#2
\end{minipage}
\endgroup%

}


\newcommand{\hardex}[1]{%

\noindent\par%
\begin{minipage}[t]{0.1\textwidth}
\begin{picture}(0,0)$\square$\end{picture}\hspace{3ex}\addtocounter{exerciseNo}{1}\textbf{\arabic{exerciseNo}}
\end{minipage}%
\begin{minipage}[t]{0.9\textwidth}
#1
\end{minipage}

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% sectionproblems environment

\newlength{\SectionProblemsSaveLengthA}
\newlength{\SectionProblemsSaveLengthB}

\newenvironment{sectionproblems}{%
  \setlength{\SectionProblemsSaveLengthA}{\parindent}
  \setlength{\SectionProblemsSaveLengthB}{\parskip}
  \setlength{\parindent}{0pt}
  \setlength{\parskip}{2pt}

  \section*{Problemas Para a Seção \the\value{chapter}.\the\value{section}}
  \setcounter{exerciseNo}{0}

}
{
  \setlength{\parindent}{\SectionProblemsSaveLengthA}
  \setlength{\parskip}{\SectionProblemsSaveLengthB}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{chapterproblems}
{
  \setlength{\SectionProblemsSaveLengthA}{\parindent}
  \setlength{\SectionProblemsSaveLengthB}{\parskip}
  \setlength{\parindent}{0pt}
  \setlength{\parskip}{2pt}

  \section*{Problemas Adicionais para o Capítulo~\the\value{chapter}}
  \sectionmark{Problemas Adicionais para o Capítulo~\the\value{chapter}}
  \addcontentsline{toc}{section}{Problemas Adicionais para o Capítulo~\the\value{chapter}}
  \setcounter{exerciseNo}{0}
}
{
  \setlength{\parindent}{\SectionProblemsSaveLengthA}
  \setlength{\parskip}{\SectionProblemsSaveLengthB}
}

\usepackage{ifthen}

\newcommand{\newdef}[2][]{%
\ifthenelse{\equal{#1}{}}%
{\textbf{#2}\index{#2}}%
{\textbf{#2}\index{#1}}%
}

\def\setR{\mathbb{R}}
\def\setHR{\hyper{\setR}}
\def\setN{\mathbb{N}}
\def\setZ{\mathbb{Z}}
\def\setQ{\mathbb{Q}}

\def\lth{\hyper{<}}
\def\definitionname{Definição}
\def\theoremname{Teorema}
\def\examplename{Exemplo}
\def\corollaryname{Corolário}
\def\lemmaname{Lema}
\spnewtheorem*{defin}{Definição}{\bfseries}{\rmfamily}
\spnewtheorem*{theor}{Teorema}{\bfseries}{\rmfamily}
\spnewtheorem*{warning}{Cuidado}{\bfseries}{\rmfamily}

\newtheorem*{lemma*}{Lema.}

\newcommand\subpart[1]{\paragraph{\textbf{#1}}}

% \narrowfigure[caption]{label}{commands}
\newcommand{\narrowfigure}[3][]{
\begin{figure}
#3
\caption{#1}
\label{#2}
\end{figure}
}

% \widefigure[caption]{label}{commands}
\newcommand{\widefigure}[3][]{
\narrowfigure[#1]{#2}{\begin{center}#3\end{center}}
}

% \narrowfigurefile[caption]{label}{path}
\newcommand{\narrowfigurefile}[3][]{
\narrowfigure[#1]{#2}{\includegraphics{#3}}
}

% \widefigurefile[caption]{label}{path}
\newcommand{\widefigurefile}[3][]{
\begin{figure}
\begin{center}
\includegraphics{#3}
\caption{#1}
\label{#2}
\end{center}
\end{figure}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \includefig[caption]{filename}
%   this command creates a float, includes a picture from a file
%   and defines a label fig:filename
%   must have \graphicspath set beforehand
\newcommand{\includefig}[2][]{
\begin{figure}
\begin{center}
\includegraphics{#2}
\caption{#1}
\label{fig:#2}
\end{center}
\end{figure}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \captions{left}{right}
% \includefigs{filenameleft}{filenameright}
%   these two commands define the captions, creates a float with
%   two pictures side by side and define the labels fig:filenameleft
%   and fig:filenameright
\def\TheLeftCaption{}
\def\TheRightCaption{}

\newcommand{\captions}[2]{
\def\TheLeftCaption{#1}
\def\TheRightCaption{#2}
}

\newsavebox{\IncludeFigLeftBox}
\newsavebox{\IncludeFigRightBox}

\newlength{\IncludeFigLeftBoxWidth}
\newlength{\IncludeFigRightBoxWidth}

\newcommand{\includefigs}[2]{
\savebox{\IncludeFigLeftBox}{\includegraphics{#1}}
\savebox{\IncludeFigRightBox}{\includegraphics{#2}}
\settowidth{\IncludeFigLeftBoxWidth}{\usebox{\IncludeFigLeftBox}}
\settowidth{\IncludeFigRightBoxWidth}{\usebox{\IncludeFigRightBox}}
\begin{figure}
\begin{minipage}[b]{\IncludeFigLeftBoxWidth}
\usebox{\IncludeFigLeftBox}
\caption{\TheLeftCaption}
\label{fig:#1}
\end{minipage}%
\hfill%
\begin{minipage}[b]{\IncludeFigRightBoxWidth}
\usebox{\IncludeFigRightBox}
\caption{\TheRightCaption}
\label{fig:#2}
\end{minipage}
\end{figure}
\def\TheLeftCaption{}
\def\TheRightCaption{}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \narrowtable[caption]{label}{coldef}{table}
\newcommand{\narrowtable}[4][]{
\begin{table}
\caption{#1}
\label{#2}
\begin{tabular}{#3}
#4
\end{tabular}
\end{table}
}

% \widetable[caption]{label}{coldef}{table}
\newcommand{\widetable}[4][]{
\begin{table}
\caption{#1}
\label{#2}
\begin{center}
\begin{tabular}{#3}
#4
\end{tabular}
\end{center}
\end{table}
}

\DeclareMathOperator{\std}{st}
\newcommand\Std[1]{\std\left(#1\right)}
\newcommand\st[1]{\std\left(#1\right)}

\def\endproof{\hfill$\blacksquare$}

\DeclareMathOperator{\sen}{sen}
\newcommand{\e}{e}

\def\SPC{\hspace{2ex}}

\spnewtheorem{contexample}{Exemplo}{\itshape}{\rmfamily}

\usepackage{refcount}

\newenvironment{examplecont}[1]%
{\setcounterref{contexample}{#1}\addtocounter{contexample}{-1}\begin{contexample}[continuação]}%
{\end{contexample}}

\newenvironment{absolutelynopagebreak}
  {\par\nobreak\vfil\penalty0\vfilneg
   \vtop\bgroup}
  {\par\xdef\tpd{\the\prevdepth}\egroup
   \prevdepth=\tpd}

\newenvironment{exsolution}
  {\noindent\emph{Solução:} }
  {}
